
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Retrieving the code from Git and Importing into GT.M &mdash; VISTA  documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/bootstrap-2.2.1.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/bootstrap-responsive-2.2.1.min.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/bootstrap-2.2.1.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="VISTA  documentation" href="index.html" />
    <link rel="next" title="Installing Caché" href="InstallCache.html" />
    <link rel="prev" title="Retrieving the code from Git and Importing into Caché" href="ImportCache.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>
<div class="container">
  
  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a class="brand" href="index.html">Documentation</a>
      <span class="navbar-text pull-left"><b></b></span>

      <div class="nav-collapse">
        <ul class="nav">
          <li class="divider-vertical"></li>
          
            <li class="dropdown">
  <a href="index.html" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ChoosingMUMPSEnvironment.html">Choosing the MUMPS Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="ImportCache.html">Retrieving the code from Git and Importing into Caché</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Retrieving the code from Git and Importing into GT.M</a></li>
<li class="toctree-l1"><a class="reference internal" href="InstallCache.html">Installing Caché</a></li>
<li class="toctree-l1"><a class="reference internal" href="InstallGTM.html">Installing GT.M</a></li>
<li class="toctree-l1"><a class="reference internal" href="ObtainingTestingCode.html">Obtaining the Testing Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="ObtainingandInstallAuxPrograms.html">Obtaining and Installing Auxiliary Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html">Instructions for Establishing and Testing the OSEHRA Code Base</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReviewingResults.html">Viewing the Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="RunningandUploadingTests.html">Running and Uploading OSEHRA Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="SetupTestingEnvironment.html">Set up the Testing Environment</a></li>
</ul>
</ul>
</li>
          
          
            
		<li class="relation-container">
  			<a href="InstallCache.html"
        	 title="next chapter" class="relation">Next &raquo;</a>
        	 <a href="ImportCache.html"
        	 title="previous chapter" class="relation">&laquo; Prev</a>
        </li>
          
          
        </ul>
        
          
<form class="navbar-search pull-right" style="margin-bottom:-3px;" action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        
      </div>
    </div>
  </div>

  
    <div class="localtoc table-bordered"><ul>
<li><a class="reference internal" href="#">Retrieving the code from Git and Importing into GT.M</a><ul>
<li><a class="reference internal" href="#packing-routines-and-globals">Packing Routines and Globals</a></li>
<li><a class="reference internal" href="#import-the-routines">Import the Routines</a></li>
<li><a class="reference internal" href="#configure-the-vista-environment">Configure the VistA Environment</a></li>
</ul>
</li>
</ul>
</div>


  
  <div class="section" id="retrieving-the-code-from-git-and-importing-into-gt-m">
<h1>Retrieving the code from Git and Importing into GT.M<a class="headerlink" href="#retrieving-the-code-from-git-and-importing-into-gt-m" title="Permalink to this headline">¶</a></h1>
<p>Starting from an empty instance of GT.M, we need to retrieve the routines and globals that will populate the VistA environment from the OSEHRA Code Repository at code.osehra.org. Begin by bringing up a Linux terminal.  To obtain a copy of the repository, create a directory (Folder) to hold the repository code and &#8220;cd&#8221; into that directory. Enter the commands</p>
<pre class="literal-block">
$ <span class="usertype">git clone git://code.osehra.org/VistA-FOIA.git</span>
Cloning into 'VistA-FOIA'...
.
.
.
$ <span class="usertype">cd VistA-FOIA</span>
</pre>
<p>to make a local clone of the remote repository.</p>
<div class="section" id="packing-routines-and-globals">
<h2>Packing Routines and Globals<a class="headerlink" href="#packing-routines-and-globals" title="Permalink to this headline">¶</a></h2>
<p>Within the Git repository, you can see the folders that contain all that is necessary to prepare the routines and globals to be imported into the Caché instance. The Packages folder contains all of the VistA FOIA software divided by package name.  Inside each package directory lies a Routines directory and a Globals directory. The latter contains globals divided up by the FileMan files they contain. The Scripts folder contains OSEHRA python scripts and helper routines. The python scripts are used to pack and unpack the routines.ro file, while the routines are used to import and export the globals from the MUMPS environment.</p>
<p>Execute the following two commands to prepare the data for import.</p>
<pre class="literal-block">
$ <span class="usertype">git ls-files -- &quot;*.m&quot; | python Scripts/PackRO.py &gt; routines.ro</span>

$ <span class="usertype">git ls-files -- &quot;*.zwr&quot; &gt; globals.lst</span>
</pre>
<p>The first command lists all the files that have the extension &#8216;.m&#8217; and passes those names to the python script PackRO.py to pack them into file routine.ro in routine transfer format. The second command lists all files that have the extension &#8216;.zwr&#8217; and writes those into globals.lst. This list will be read by the OSEHRA ZGI routine during the import step.</p>
</div>
<div class="section" id="import-the-routines">
<h2>Import the Routines<a class="headerlink" href="#import-the-routines" title="Permalink to this headline">¶</a></h2>
<p>Importing the routines is done using the MUMPS routine named %RI. This is the MUMPS standard routine to import routines from a .RO file like what was created when the Python scripts were run. To start the GT.M instance in the terminal, simply enter the command:  gtm.</p>
<pre class="literal-block">
~/Downloads$ <span class="usertype">gtm</span>

GTM&gt;
</pre>
<p>When the &#8220;GTM&gt;&#8221; prompt is there, you are in the GT.M environment and can execute the %RI routine using the command D ^%RI.</p>
<pre class="literal-block">
GTM&gt; <span class="usertype">D ^%RI</span>

Routine Input Utility - Converts RO files to <a href="#id1"><span class="problematic" id="id2">*</span></a>.m files.

Formfeed delimited &lt;No&gt;?
</pre>
<p>The routines.ro file that was created earlier is not formfeed delimited, so the default option for the first prompt is the correct one to choose. When the prompt asks for an &#8220;Input Device,&#8221; enter the path to the routines.ro that was created in the earlier step. Our path to the routines.ro is shown entered below.</p>
<pre class="literal-block">
Formfeed delimited &lt;No&gt;? <span class="usertype">&lt;ENTER&gt;</span>
Input Device: &lt;terminal&gt;: <span class="usertype">/home/osehra/Downloads/VistA-FOIA/routines.ro</span>

Routines



Output directory:
</pre>
<p>This brings the prompt asking for the output directory. The path entered here should point to the r folder that was used to set the gtmroutines environment variable in the previous step.   In our case, the directory was::</p>
<div class="highlight-python"><pre>/home/osehra/Downloads/VistA/r/</pre>
</div>
<p>This is the location where the %RI routine will store the routines that it imports from routines.ro.</p>
<p>The &#8220;Output directory&#8221; must include the &#8220;r&#8221; subdirectory string and must finish with a slash &#8220;/&#8221;.
After entering the path, the names of the routines that are imported are shown on the terminal window as they are processed. When the routine is finished, it will display the amount of lines restored and the number of routines processed, then show the GT.M prompt.</p>
<pre class="literal-block">
Output directory:  <span class="usertype">/home/osehra/Downloads/VistA/r/</span>

PRCA219P  PRCAACC   PRCAAPI   PRCAAPR   PRCAAPR1  PRCAATR   PRCABD    PRCABIL
PRCABIL1  PRCABIL2  PRCABIL3  PRCABIL4  PRCABJ    PRCABJ1   PRCABJV   PRCABP1
.
.
.
WVYNOTP   WIIACT4   WIIADT1   WIIELG    WIIGATD   WIILM     WIILM01   WIILM02
WIILM03   WIILM04   WIISERV   ZGI       ZGO

Restored 2349289 lines in 26037 routines
</pre>
<p>Once the import process finishes, you can verify if it was succesful by visiting the &#8220;Output directory&#8221; from a terminal and using the &#8220;ls&#8221; command. This command should show  a large collection of &#8220;*.m&#8221; files that were created during the import process.</p>
<p>Importing the globals is done with the use of a routine that was just imported. The ZGI routine was written to import the globals from the OSEHRA structure into a MUMPS environment. The command to do this is:</p>
<pre class="literal-block">
GTM&gt; <span class="usertype">W $$LIST^ZGI(&quot;/path-to/VistA-FOIA/globals.lst&quot;,&quot;/path-to/VistA-FOIA/&quot;)</span>
</pre>
<p>Please note that the second string must end with a slash &#8220;/&#8221; given that it represent a directory path. If you omit the final &#8220;/&#8221; the command will not operate correctly.</p>
<p>This will take the globals.lst file and use the entries in it to tell GT.M to import that .zwr file.</p>
<p>While the routine is running, the names of the .zwr files will be printed to the screen as they are being processed. This is going through the OSEHRA Code base and importing all of the .zwr files from each package. The final package imported is the &#8220;Wounded Injured and Ill Warriors&#8221;.After the last global is imported, the program will write a &#8216;1&#8217; to the screen and will return to the GT.M prompt.</p>
</div>
<div class="section" id="configure-the-vista-environment">
<h2>Configure the VistA Environment<a class="headerlink" href="#configure-the-vista-environment" title="Permalink to this headline">¶</a></h2>
<p>Some configuration within the VistA environment is necessary before you have a full VistA instance.</p>
<p>The text below shows the routine that need to be run to configure the VistA instance. The ZTMGRSET routine will configure the VistA instance by
renaming some system-specific routines. This is done using the command:</p>
<pre class="literal-block">
GTM&gt; <span class="usertype">D ^ZTMGRSET</span>


ZTMGRSET Version 8.0 Patch level <strong>34,36,69,94,121,127,136,191,275,355,446</strong>
HELLO! I exist to assist you in correctly initializing the current account.
Which MUMPS system should I install?

1 = VAX DSM(V6), VAX DSM(V7)
2 = MSM-PC/PLUS, MSM for NT or UNIX
3 = Cache (VMS, NT, Linux), OpenM-NT
4 = Datatree, DTM-PC, DT-MAX
5 =
6 =
7 = GT.M (VMS)
8 = GT.M (Unix)
System: <span class="usertype">8</span>

I will now rename a group of routines specific to your operating system.
Routine:  ZOSVGUX Loaded, Saved as    %ZOSV

Routine:  ZIS4GTM Loaded, Saved as    %ZIS4
Routine:  ZISFGTM Loaded, Saved as    %ZISF
Routine:  ZISHGTM Loaded, Saved as    %ZISH
Routine:  XUCIGTM Loaded, Saved as    %XUCI
Routine: ZOSV2GTM Loaded, Saved as   %ZOSV2
Routine:  ZISTCPS Loaded, Saved as %ZISTCPS

NAME OF MANAGER'S UCI,VOLUME SET: VAH,ROU// <span class="usertype">PLA,PLA</span>
The value of PRODUCTION will be used in the GETENV api.
PRODUCTION (SIGN-ON) UCI,VOLUME SET: VAH,ROU// <span class="usertype">PLA,PLA</span>
The VOLUME name must match the one in PRODUCTION.
NAME OF VOLUME SET: PLA//<span class="usertype">PLA</span>
The temp directory for the system: '/tmp/'// <span class="usertype">&lt;ENTER&gt;</span>
^%ZOSF setup


Now to load routines common to all systems.
Routine:   ZTLOAD Loaded, Saved as  %ZTLOAD
Routine:  ZTLOAD1 Loaded, Saved as %ZTLOAD1
Routine:  ZTLOAD2 Loaded, Saved as %ZTLOAD2
Routine:  ZTLOAD3 Loaded, Saved as %ZTLOAD3
Routine:  ZTLOAD4 Loaded, Saved as %ZTLOAD4
Routine:  ZTLOAD5 Loaded, Saved as %ZTLOAD5
Routine:  ZTLOAD6 Loaded, Saved as %ZTLOAD6
Routine:  ZTLOAD7 Loaded, Saved as %ZTLOAD7
Routine:      ZTM Loaded, Saved as     %ZTM
Routine:     ZTM0 Loaded, Saved as    %ZTM0
Routine:     ZTM1 Loaded, Saved as    %ZTM1
Routine:     ZTM2 Loaded, Saved as    %ZTM2
Routine:     ZTM3 Loaded, Saved as    %ZTM3
Routine:     ZTM4 Loaded, Saved as    %ZTM4
Routine:     ZTM5 Loaded, Saved as    %ZTM5
Routine:     ZTM6 Loaded, Saved as    %ZTM6
Routine:     ZTMS Loaded, Saved as    %ZTMS
Routine:    ZTMS0 Loaded, Saved as   %ZTMS0
Routine:    ZTMS1 Loaded, Saved as   %ZTMS1
Routine:    ZTMS2 Loaded, Saved as   %ZTMS2
Routine:    ZTMS3 Loaded, Saved as   %ZTMS3
Routine:    ZTMS4 Loaded, Saved as   %ZTMS4
Routine:    ZTMS5 Loaded, Saved as   %ZTMS5
Routine:    ZTMS7 Loaded, Saved as   %ZTMS7
Routine:    ZTMSH Loaded, Saved as   %ZTMSH
Routine:     ZTER Loaded, Saved as    %ZTER
Routine:    ZTER1 Loaded, Saved as   %ZTER1
Routine:      ZIS Loaded, Saved as     %ZIS
Routine:     ZIS1 Loaded, Saved as    %ZIS1
Routine:     ZIS2 Loaded, Saved as    %ZIS2
Routine:     ZIS3 Loaded, Saved as    %ZIS3
Routine:     ZIS5 Loaded, Saved as    %ZIS5
Routine:     ZIS6 Loaded, Saved as    %ZIS6
Routine:     ZIS7 Loaded, Saved as    %ZIS7
Routine:     ZISC Loaded, Saved as    %ZISC
Routine:     ZISP Loaded, Saved as    %ZISP
Routine:     ZISS Loaded, Saved as    %ZISS
Routine:    ZISS1 Loaded, Saved as   %ZISS1
Routine:    ZISS2 Loaded, Saved as   %ZISS2
Routine:   ZISTCP Loaded, Saved as  %ZISTCP
Routine:   ZISUTL Loaded, Saved as  %ZISUTL
Routine:     ZTPP Loaded, Saved as    %ZTPP
Routine:     ZTP1 Loaded, Saved as    %ZTP1
Routine:   ZTPTCH Loaded, Saved as  %ZTPTCH
Routine:   ZTRDEL Loaded, Saved as  %ZTRDEL
Routine:   ZTMOVE Loaded, Saved as  %ZTMOVE
Want to rename the FileMan routines: No// <span class="usertype">Y</span>
Routine:     DIDT Loaded, Saved as      %DT
Routine:    DIDTC Loaded, Saved as     %DTC
Routine:    DIRCR Loaded, Saved as     %RCR
Setting ^%ZIS('C')

Now, I will check your % globals...........

ALL DONE
GTM&gt;
</pre>
<p>After loading a few routines, the configuration will ask you for the names of the box/volume pair of the system, the name of the manager&#8217;s namespace, and the temp directory.  shows the default answers being accepted for these prompts. They can be set if you need a specific name, but we used the defaults of PLA for all names and the /tmp/ directory for the system.</p>
<p>Note: The NAME OF MANAGER&#8217;S UCI, VOLUME SET and PRODUCTION (SIGN-ON) UCI,VOLUME SET prompts should be set to PLA,PLA if more than XINDEX functionality is desired.</p>
<p>It will load and save some other routines, then ask if you &#8220;Want to rename the FileMan routines:.&#8221; We answer this option with a YES. The routine then loads three more routines, checks the % globals, and exits. Now you are ready to start testing the OSEHRA Code base.</p>
<p>Some developers have encountered errors being displayed during the configuation process.  See the second entry on the Troubleshooting Page to see if the errors are the same and find any solutions.</p>
</div>
</div>


</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right" id="footer-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
      Created using <a href="http://sphinx.pocoo.org/" target="_blank">Sphinx</a> 1.1.3.<br/>
    </p>
    <p class="pull-left" id="footer-left">
      Except where otherwise noted, content on this site is licensed under a <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">Creative Commons Attribution 3.0 License</a>.
    </p>
    </div>
  </div>
</footer>
  </body>
</html>